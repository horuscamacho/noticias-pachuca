---
import { DashboardWrapper } from '@/components/DashboardWrapper'

export interface Props {
	title: string;
}

const { title } = Astro.props;
---

<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>{title}</title>
	<style>
		@import "../styles/global.css";
	</style>
</head>
<body class="antialiased">
	<!-- Auth protection script -->
	<script>
		if (typeof window !== 'undefined') {
			const authData = localStorage.getItem('auth-state');
			if (!authData) {
				window.location.href = '/login';
			} else {
				try {
					const parsedAuth = JSON.parse(authData);
					if (!parsedAuth.isAuthenticated || !parsedAuth.accessToken) {
						window.location.href = '/login';
					}
				} catch (e) {
					window.location.href = '/login';
				}
			}
		}
	</script>

	<DashboardWrapper client:load>
		<slot />
	</DashboardWrapper>
</body>
</html>